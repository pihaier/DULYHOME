# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is the **Duly Trading ERP System (ÎëêÎ¶¨Î¨¥Ïó≠ ERP ÏãúÏä§ÌÖú)** - a comprehensive ERP platform for Korea-China trade operations. After complete codebase deletion on 2025-01-27, the project is being rebuilt from scratch based on 21 comprehensive project documents.

‚ö†Ô∏è **REBUILD STATUS**: Phase 2 in progress (2025-01-28) - Core infrastructure being implemented following 00_INDEX.md roadmap.

## üõ†Ô∏è **MCP (Model Context Protocol) Tools Usage**

When developing this project, Claude Code MUST utilize the following MCP tools:

### Required MCP Tools:
- **üìÇ Desktop MCP** (`mcp__desktop-commander`): For file operations, code analysis, and local development
- **üîÑ Sequential Thinking MCP** (`mcp__mcp-sequentialthinking-tools`): For complex problem-solving and planning
- **‚òÅÔ∏è Supabase MCP** (`mcp__supabase`): For database operations, migrations, and backend management
- **üìö Context7 MCP** (`mcp__context7-mcp`): For documentation lookup and library references

### MCP Usage Guidelines:
```bash
# Example workflow using MCP tools
1. Use desktop MCP to read current implementation
2. Use seq MCP to plan complex changes
3. Use supabase MCP to verify database schema
4. Use c7 MCP to check library documentation
```

## üìã **Project Documentation Reference**

**üéØ ÌïµÏã¨ ÏõêÏπô: "Î¨∏ÏÑú Í∏∞Î∞ò Í∞úÎ∞ú" - Î™®Îì† ÏΩîÎî©ÏùÄ Î¨∏ÏÑúÏóê Í∏∞Î∞òÌïòÏó¨ ÏßÑÌñâ**

### üìÅ **ÌîÑÎ°úÏ†ùÌä∏ Î¨∏ÏÑú Íµ¨Ï°∞** (`/project-docs/`)
21Í∞ú ÌëúÏ§Ä ÌîÑÎ°úÏ†ùÌä∏ Î¨∏ÏÑúÍ∞Ä Ï≤¥Í≥ÑÏ†ÅÏúºÎ°ú Ï†ïÎ¶¨ÎêòÏñ¥ ÏûàÏäµÎãàÎã§:

- **üìñ ÏãúÏûëÏ†ê**: [`00_INDEX.md`](./project-docs/00_INDEX.md) - Ï†ÑÏ≤¥ Î¨∏ÏÑú Ïù∏Îç±Ïä§ Î∞è ÏßÑÌñâ ÌòÑÌô©
- **üè¢ Í∏∞Ìöç Î¨∏ÏÑú (01-06)**: ÌîÑÎ°úÏ†ùÌä∏ ÌóåÏû•, ÎπÑÏ¶àÎãàÏä§ ÏºÄÏù¥Ïä§, Ï†ÑÏ≤¥ Í∏∞ÌöçÏÑú Îì±
- **üîß Í∏∞Ïà† Î¨∏ÏÑú (07-12)**: ÏöîÍµ¨ÏÇ¨Ìï≠, ÏïÑÌÇ§ÌÖçÏ≥ê, ÌîÑÎ°†Ìä∏ÏóîÎìú/Î∞±ÏóîÎìú ÏÑ§Í≥Ñ Îì±  
- **‚úÖ ÌíàÏßà Î¨∏ÏÑú (13-15)**: ÌÖåÏä§Ìä∏ Í≥ÑÌöç, ÏΩîÎìú Í∑úÎ≤î, Í≤ÄÏàò Í∏∞Ï§Ä
- **üöÄ Ïö¥ÏòÅ Î¨∏ÏÑú (16-18)**: Î∞∞Ìè¨, Ïö¥ÏòÅ Îß§Îâ¥Ïñº, ÏÇ¨Ïö©Ïûê Í∞ÄÏù¥Îìú
- **üìù Ïú†ÏßÄÎ≥¥Ïàò (19-20)**: Î≥ÄÍ≤Ω Î°úÍ∑∏, GitHub ÎùºÏù¥Î∏åÎü¨Î¶¨ Ï∂îÏ≤ú

### üí° **Í∞úÎ∞ú ÏõåÌÅ¨ÌîåÎ°úÏö∞ - Î¨∏ÏÑúÎ≥Ñ Í∞úÎ∞ú Í∞ÄÏù¥Îìú**

#### 1Ô∏è‚É£ **ÌîÑÎ°úÏ†ùÌä∏ Ïù¥Ìï¥ Îã®Í≥Ñ**
```
ÌïÑÏàò ÏùΩÍ∏∞:
‚îú‚îÄ‚îÄ 01_PROJECT_CHARTER.md      ‚Üí ÌîÑÎ°úÏ†ùÌä∏ Î™©ÌëúÏôÄ Î≤îÏúÑ Ïù¥Ìï¥
‚îú‚îÄ‚îÄ 02_BUSINESS_CASE.md        ‚Üí ÎπÑÏ¶àÎãàÏä§ Í∞ÄÏπòÏôÄ ROI Ïù¥Ìï¥
‚îú‚îÄ‚îÄ 03_OVERALL_PLANNING.md     ‚Üí Ï†ÑÏ≤¥ ÏãúÏä§ÌÖú Íµ¨Ï°∞ ÌååÏïÖ
‚îî‚îÄ‚îÄ 07_REQUIREMENTS.md         ‚Üí Í∏∞Îä• ÏöîÍµ¨ÏÇ¨Ìï≠ ÏÉÅÏÑ∏ ÌôïÏù∏
```

#### 2Ô∏è‚É£ **Í∞úÎ∞ú Ï§ÄÎπÑ Îã®Í≥Ñ**
```
ÏïÑÌÇ§ÌÖçÏ≤ò ÌôïÏù∏:
‚îú‚îÄ‚îÄ 08_TECH_ARCHITECTURE.md    ‚Üí Í∏∞Ïà† Ïä§ÌÉù Î∞è ÏïÑÌÇ§ÌÖçÏ≤ò Ìå®ÌÑ¥
‚îú‚îÄ‚îÄ 09_FRONTEND_DESIGN.md      ‚Üí 82Í∞ú ÌéòÏù¥ÏßÄ UI/UX ÏÑ§Í≥Ñ
‚îú‚îÄ‚îÄ 10_BACKEND_DESIGN.md       ‚Üí API Íµ¨Ï°∞ Î∞è ÏÑúÎ≤Ñ Î°úÏßÅ
‚îú‚îÄ‚îÄ 11_DATABASE_DESIGN.md      ‚Üí ÌÖåÏù¥Î∏î Íµ¨Ï°∞ Î∞è RLS Ï†ïÏ±Ö
‚îú‚îÄ‚îÄ SERVICE_FIELDS_DEFINITION.md ‚Üí 7Í∞ú ÏÑúÎπÑÏä§Î≥Ñ ÌïÑÎìú Ï†ïÏùò
‚îî‚îÄ‚îÄ 12_API_DOCUMENTATION.md    ‚Üí RESTful API Î™ÖÏÑ∏
```

#### 3Ô∏è‚É£ **ÏΩîÎî© Îã®Í≥Ñ**
```
Í∞úÎ∞ú Í∑úÏπô:
‚îú‚îÄ‚îÄ 14_CODE_STANDARDS.md       ‚Üí TypeScript/React ÏΩîÎî© Í∑úÎ≤î
‚îú‚îÄ‚îÄ 13_TEST_PLAN.md           ‚Üí ÌÖåÏä§Ìä∏ ÏûëÏÑ± Í∞ÄÏù¥Îìú
‚îî‚îÄ‚îÄ 15_ACCEPTANCE_CRITERIA.md  ‚Üí Í∏∞Îä•Î≥Ñ ÏôÑÎ£å Í∏∞Ï§Ä
```

#### 4Ô∏è‚É£ **Î∞∞Ìè¨ Î∞è Ïö¥ÏòÅ Îã®Í≥Ñ**
```
Ïö¥ÏòÅ Ï§ÄÎπÑ:
‚îú‚îÄ‚îÄ 16_DEPLOYMENT.md          ‚Üí Vercel/Supabase Î∞∞Ìè¨ Ï†àÏ∞®
‚îú‚îÄ‚îÄ 17_OPERATIONS_MANUAL.md   ‚Üí Ïö¥ÏòÅ Î∞è Î™®ÎãàÌÑ∞ÎßÅ
‚îú‚îÄ‚îÄ 18_USER_MANUAL.md         ‚Üí ÏÇ¨Ïö©Ïûê Í∞ÄÏù¥Îìú
‚îî‚îÄ‚îÄ 19_CHANGELOG.md           ‚Üí Î≥ÄÍ≤ΩÏÇ¨Ìï≠ Í∏∞Î°ù
```

### üö® **ÌòÑÏû¨ Í∞úÎ∞ú ÏÉÅÌô© (2025-01-28)**
- **ÏΩîÎìúÎ≤†Ïù¥Ïä§**: 2025-01-27 Ï†ÑÏ≤¥ ÏÇ≠Ï†ú ÌõÑ Ïû¨Íµ¨Ï∂ï Ï§ë
- **ÏßÑÌñâ Îã®Í≥Ñ**: Phase 2 - ÌïµÏã¨ Í∏∞Îä• Íµ¨ÌòÑ (00_INDEX.md Ï∞∏Ï°∞)
- **ÏôÑÎ£å ÏÇ¨Ìï≠**: 
  - ‚úÖ Next.js 15 ÌîÑÎ°úÏ†ùÌä∏ Ï¥àÍ∏∞Ìôî
  - ‚úÖ Tailwind CSS Plus ÌÖúÌîåÎ¶ø ÌÜµÌï©
  - ‚úÖ 7Í∞ú ÏÑúÎπÑÏä§ Ìè¥Îçî Íµ¨Ï°∞ ÏÉùÏÑ±
- **ÏßÑÌñâ Ï§ë**:
  - üöß Supabase Ïä§ÌÇ§Îßà ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò
  - üöß RLS Ï†ïÏ±Ö ÏÑ§Ï†ï
  - üöß Í∏∞Î≥∏ Ïù∏Ï¶ù ÏãúÏä§ÌÖú Íµ¨ÌòÑ

### üìä **Í∞úÎ∞ú Ïãú Î¨∏ÏÑú Ï∞∏Ï°∞ Îß§Ìä∏Î¶≠Ïä§**

| Í∞úÎ∞ú ÏûëÏóÖ | ÌïÑÏàò Ï∞∏Ï°∞ Î¨∏ÏÑú | MCP ÎèÑÍµ¨ ÌôúÏö© |
|-----------|---------------|--------------|
| **ÏÉà Í∏∞Îä• Ï∂îÍ∞Ä** | 07_REQUIREMENTS.md ‚Üí 09_FRONTEND_DESIGN.md ‚Üí SERVICE_FIELDS_DEFINITION.md | desktop MCPÎ°ú Í∏∞Ï°¥ ÏΩîÎìú Î∂ÑÏÑù |
| **API Í∞úÎ∞ú** | 12_API_DOCUMENTATION.md ‚Üí 10_BACKEND_DESIGN.md ‚Üí 14_CODE_STANDARDS.md | supabase MCPÎ°ú DB Ïä§ÌÇ§Îßà ÌôïÏù∏ |
| **DB Ïä§ÌÇ§Îßà Î≥ÄÍ≤Ω** | 11_DATABASE_DESIGN.md ‚Üí SERVICE_FIELDS_DEFINITION.md | supabase MCPÎ°ú ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò ÏÉùÏÑ± |
| **ÌÖåÏä§Ìä∏ ÏûëÏÑ±** | 13_TEST_PLAN.md ‚Üí 15_ACCEPTANCE_CRITERIA.md | seq MCPÎ°ú ÌÖåÏä§Ìä∏ ÏãúÎÇòÎ¶¨Ïò§ Í≥ÑÌöç |
| **Î≤ÑÍ∑∏ ÏàòÏ†ï** | 07_REQUIREMENTS.md ‚Üí Ìï¥Îãπ ÏÑ§Í≥Ñ Î¨∏ÏÑú ‚Üí 19_CHANGELOG.md | desktop MCPÎ°ú Î≤ÑÍ∑∏ Ï∂îÏ†Å |
| **ÏÑ±Îä• ÏµúÏ†ÅÌôî** | 11_DATABASE_DESIGN.md (ÏÑπÏÖò 5.5) ‚Üí 17_OPERATIONS_MANUAL.md (ÏÑπÏÖò 11) | seq MCPÎ°ú ÏµúÏ†ÅÌôî Ï†ÑÎûµ ÏàòÎ¶Ω |
| **Î≥¥Ïïà Í∞ïÌôî** | 14_CODE_STANDARDS.md (ÏÑπÏÖò 9) ‚Üí 16_DEPLOYMENT.md (ÏÑπÏÖò 11.2) | c7 MCPÎ°ú Î≥¥Ïïà ÎùºÏù¥Î∏åÎü¨Î¶¨ ÌôïÏù∏ |

### Core Business Value (from 02_BUSINESS_CASE.md)
- **Complete Automation**: From application to report delivery (70% time reduction)
- **Real-time Translation**: GPT-4 powered Korean‚ÜîChinese instant translation
- **Unified Platform**: 6 roles (customer, chinese_staff, korean_team, admin, inspector, factory)
- **No-login Access**: Simple access with reservation number (DL-YYYYMMDD-XXXXXX)
- **CRM Integration**: Complete integration with existing business systems
- **ROI**: 470% expected return on investment
- **Revenue Growth**: 5.4ÏñµÏõê annual revenue increase projected

## Technology Stack

- **Framework**: Next.js 15 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS + shadcn/ui components + Tailwind CSS Plus templates
- **Database**: Supabase (PostgreSQL with Row Level Security)
- **Real-time**: Supabase Realtime (for chat functionality)
- **Authentication**: Supabase Auth (email/password, OAuth providers, MFA)
- **AI Integration**: OpenAI GPT-4 (for real-time translation)
- **File Processing**: mammoth.js (Word to HTML conversion)
- **State Management**: React Context API (GlobalContext)
- **Server State**: React Query (for data fetching)
- **Email Service**: TBD (for automated notifications)

## Important Development Rules

### ‚ö†Ô∏è Database Migration Rules
**NEVER use MCP tools for database migrations!** 
- ‚ùå Do NOT use `mcp__supabase__apply_migration` 
- ‚ùå Do NOT use `mcp__supabase__execute_sql` for DDL operations
- ‚úÖ ALWAYS use Supabase CLI commands for migrations
- ‚úÖ Test locally first with `npx supabase db reset --local`
- ‚úÖ Apply to production with `npx supabase db push`
- ‚úÖ Refer to `CLI_COMMANDS.md` for proper migration commands

## Development Commands

```bash
# Navigate to Next.js directory first
cd nextjs

# Install dependencies
npm install

# Run development server (http://localhost:3000)
npm run dev

# Build for production
npm run build

# Run production server
npm run start

# Run linter
npm run lint

# Type checking  
npm run type-check

# Run tests
npm run test

# Run tests in watch mode
npm run test:watch

# Supabase commands (from project root)
npx supabase login
npx supabase link
npx supabase config push
npx supabase migrations up --linked
npx supabase db reset --linked  # Reset local database
npx supabase gen types typescript --linked > nextjs/src/lib/types/database.ts
```

## Project Structure

The main application is in the `nextjs/` directory:

- `src/app/`: Next.js App Router pages
  - `api/`: API routes (auth, webhooks, integrations)
  - `application/`: Inspection application pages
    - `new/`: New application form
    - `[reservationNumber]/`: Application details view
  - `chat/`: Real-time chat system
    - `[reservationNumber]/`: Chat room by reservation
  - `dashboard/`: Role-based dashboards
  - `admin/`: Admin panel (korean_team only)
  - `crm/`: CRM system (korean_team only)
  - `auth/`: Authentication pages
  - `profile/`: User profile management
  - `legal/`: Privacy policy and terms pages
- `src/components/`: Reusable React components
- `src/lib/`: Utilities and configurations
  - `context/`: GlobalContext for user state management
  - `supabase/`: Supabase client configurations (browser, server, service)
  - `types.ts`: TypeScript type definitions
- `supabase/`: Database migrations and configuration
- `tailwind css/`: Additional Tailwind templates for reference

## Environment Variables (16_DEPLOYMENT.md ÏÑπÏÖò 5 Ï∞∏Ï°∞)

Required environment variables (set in `.env.local`):

```bash
# Supabase (ÏûêÎèô ÎèôÍ∏∞Ìôî - Vercel Integration ÏÇ¨Ïö©)
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# OpenAI (for GPT-4 translation)
OPENAI_API_KEY=your_openai_api_key

# Rate Limiting (12_API_DOCUMENTATION.md Ï∞∏Ï°∞)
UPSTASH_REDIS_REST_URL=your_upstash_url
UPSTASH_REDIS_REST_TOKEN=your_upstash_token

# Email Service
EMAIL_SERVICE_API_KEY=your_email_service_key
EMAIL_FROM_ADDRESS=noreply@duly.co.kr

# File Upload (14_CODE_STANDARDS.md ÏÑπÏÖò 9.4 Ï∞∏Ï°∞)
MAX_FILE_SIZE=10485760  # 10MB in bytes
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf

# Application Settings (02_BUSINESS_CASE.md Ï∞∏Ï°∞)
DAILY_RATE=290000  # Korean Won
MARGIN_PERCENTAGE=50  # 50% margin

# Security (14_CODE_STANDARDS.md ÏÑπÏÖò 9.6 Ï∞∏Ï°∞)
ENCRYPTION_KEY=32_character_encryption_key_here
JWT_SECRET=your_jwt_secret_minimum_32_chars
CSRF_SECRET=your_csrf_secret_key
```

## Key Architectural Patterns

### 1. Multi-Role Access Control
Six distinct user roles with different permissions:
- `customer`: Can submit applications, view own data
- `chinese_staff`: Manages assigned inspections, uploads reports
- `korean_team`: Full system access except admin panel
- `admin`: Full system access including admin panel
- `inspector`: Guest access to chat only
- `factory`: Guest access to chat only

**Role checking pattern:**
```typescript
// Use the useUser hook from GlobalContext
const { user, userProfile } = useUser();
const isAdmin = userProfile?.role === 'admin';
const isKoreanTeam = ['korean_team', 'admin'].includes(userProfile?.role);
```

### 2. Reservation Number System
- Format: `DL-YYYYMMDD-XXXXXX` (e.g., DL-20240115-123456)
- Allows no-login access to application details and chat
- Primary identifier for all transactions

### 3. Real-time Translation Architecture
- All chat messages stored in both original and translated versions
- GPT-4 API handles context-aware translation
- Korean users see Korean only, Chinese users see Chinese only
- Korean team sees both original and translated messages

### 4. Supabase Client Pattern (inherited)
- `createClient()`: Browser client for client components
- `createServerClient()`: Server client for server components and route handlers
- `createServiceClient()`: Service role client for admin operations

**‚ö†Ô∏è CRITICAL: Vercel-Supabase Integration ÌôòÍ≤ΩÎ≥ÄÏàò ÏÑ§Ï†ï**
```bash
# Vercel-Supabase Í≥µÏãù Integration ÏÇ¨Ïö© Ïãú ÌôòÍ≤ΩÎ≥ÄÏàò ÌòïÌÉú:
SUPABASE_URL=https://project-ref.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SUPABASE_JWT_SECRET=your-jwt-secret

# Î°úÏª¨ Í∞úÎ∞úÏö© (NEXT_PUBLIC_ prefix ÌïÑÏöî):
NEXT_PUBLIC_SUPABASE_URL=https://project-ref.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# next.config.jsÏóêÏÑú Vercel Integration ÌôòÍ≤ΩÎ≥ÄÏàòÎ•º ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏Ïö©ÏúºÎ°ú Îß§Ìïë:
env: {
  NEXT_PUBLIC_SUPABASE_URL: process.env.SUPABASE_URL || process.env.NEXT_PUBLIC_SUPABASE_URL,
  NEXT_PUBLIC_SUPABASE_ANON_KEY: process.env.SUPABASE_ANON_KEY || process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,
}
```

**Usage patterns:**
```typescript
// Client components - Îëê ÌôòÍ≤ΩÎ≥ÄÏàò Î™®Îëê ÏßÄÏõê
import { createClient } from '@/lib/supabase/client'
const supabase = createClient()

// Server components and API routes - Îëê ÌôòÍ≤ΩÎ≥ÄÏàò Î™®Îëê ÏßÄÏõê
import { createServerClient } from '@/lib/supabase/server'
const supabase = createServerClient()

// Admin operations
import { createServiceClient } from '@/lib/supabase/service'
const supabase = createServiceClient()
```

### 5. File Upload Strategy
- Supabase Storage for file management
- Automatic compression for images/videos
- Multiple file support (up to 5 files per application)
- Secure file access with RLS policies

## Workflow Automation

### Application Flow
1. Customer submits application ‚Üí Auto-assigns to chinese_staff
2. Chinese staff coordinates with factory ‚Üí Sends quote
3. Customer pays ‚Üí Korean team confirms ‚Üí Inspection proceeds
4. Chinese staff uploads report ‚Üí Korean team translates/reviews
5. Customer receives final report

### Status Transitions
- `submitted` ‚Üí `quoted` ‚Üí `paid` ‚Üí `in_progress` ‚Üí `completed`
- Payment timeout: Auto-cancellation if not paid by deadline
- 3-day rule: Auto-deletion if no response

## Page Reference

All page implementations should follow the specifications in `/Users/gimduho/Desktop/erpÏª§Ïä§ÌÖÄ/page.md`, which contains:
- Detailed field definitions for each page
- Role-based access permissions
- UI/UX requirements
- Business logic rules

## Important Implementation Notes

1. **Development Status**: This project is in active development phase. All functionalities are being implemented from scratch.

2. **Language Handling**:
   - System auto-detects language (Korean default)
   - Chinese users can manually switch to Chinese
   - All customer-facing content in Korean
   - All China-facing content in Chinese

3. **Guest Access Pattern**:
   - Chinese staff generates unique URLs for factory/inspector
   - URLs include embedded authentication tokens
   - No login required for guest roles

4. **Pricing Logic**:
   - 1-4 days: 290,000 KRW/day
   - 5-9 days: 270,000 KRW/day
   - 10+ days: 250,000 KRW/day
   - 50% margin added (customer doesn't see this)

5. **Security Considerations**:
   - Never expose margin information to customers
   - All financial calculations server-side only
   - Guest URLs expire after inspection completion
   - File uploads scanned and validated

6. **Integration Points**:
   - GPT-4 API for translation (maintain context)
   - Email service for notifications
   - Google Search API for CRM features
   - Existing duly.co.kr website for reference

## Database Schema

### Core Tables Structure

```sql
-- Users and Authentication
users (Supabase Auth)
‚îú‚îÄ‚îÄ id: uuid
‚îú‚îÄ‚îÄ email: string
‚îú‚îÄ‚îÄ role: enum (customer, chinese_staff, korean_team, admin, inspector, factory)
‚îî‚îÄ‚îÄ created_at: timestamp

user_profiles
‚îú‚îÄ‚îÄ user_id: uuid (FK ‚Üí users.id)
‚îú‚îÄ‚îÄ company_name: string
‚îú‚îÄ‚îÄ company_name_chinese: string
‚îú‚îÄ‚îÄ contact_person: string
‚îú‚îÄ‚îÄ phone: string
‚îú‚îÄ‚îÄ language_preference: enum (ko, zh)
‚îú‚îÄ‚îÄ approval_status: enum (pending, approved, rejected)
‚îî‚îÄ‚îÄ updated_at: timestamp

-- Inspection Applications
inspection_applications
‚îú‚îÄ‚îÄ id: uuid
‚îú‚îÄ‚îÄ reservation_number: string (unique, DL-YYYYMMDD-XXXXXX)
‚îú‚îÄ‚îÄ user_id: uuid (FK ‚Üí users.id)
‚îú‚îÄ‚îÄ company_name: string
‚îú‚îÄ‚îÄ contact_person: string
‚îú‚îÄ‚îÄ contact_phone: string
‚îú‚îÄ‚îÄ contact_email: string
‚îú‚îÄ‚îÄ service_type: enum (quality_inspection, factory_audit, loading_inspection)
‚îú‚îÄ‚îÄ product_name: string
‚îú‚îÄ‚îÄ product_name_translated: string
‚îú‚îÄ‚îÄ production_quantity: integer
‚îú‚îÄ‚îÄ inspection_method: enum (standard, full)
‚îú‚îÄ‚îÄ factory_name: string
‚îú‚îÄ‚îÄ factory_contact_person: string
‚îú‚îÄ‚îÄ factory_contact_phone: string
‚îú‚îÄ‚îÄ factory_address: string
‚îú‚îÄ‚îÄ schedule_coordination_status: enum (not_coordinated, coordinated)
‚îú‚îÄ‚îÄ inspection_start_date: date
‚îú‚îÄ‚îÄ inspection_days: integer
‚îú‚îÄ‚îÄ special_requirements: text
‚îú‚îÄ‚îÄ special_requirements_translated: text
‚îú‚îÄ‚îÄ status: enum (submitted, quoted, paid, in_progress, completed, cancelled)
‚îú‚îÄ‚îÄ payment_status: enum (pending, paid, refunded)
‚îú‚îÄ‚îÄ total_amount: decimal
‚îú‚îÄ‚îÄ margin_amount: decimal
‚îú‚îÄ‚îÄ assigned_chinese_staff: uuid (FK ‚Üí users.id)
‚îú‚îÄ‚îÄ confirmed_start_date: date
‚îú‚îÄ‚îÄ confirmed_end_date: date
‚îú‚îÄ‚îÄ created_at: timestamp
‚îî‚îÄ‚îÄ updated_at: timestamp

-- Chat System
chat_messages
‚îú‚îÄ‚îÄ id: uuid
‚îú‚îÄ‚îÄ reservation_number: string (FK ‚Üí inspection_applications.reservation_number)
‚îú‚îÄ‚îÄ sender_id: uuid (FK ‚Üí users.id)
‚îú‚îÄ‚îÄ sender_name: string
‚îú‚îÄ‚îÄ sender_role: string
‚îú‚îÄ‚îÄ original_message: text
‚îú‚îÄ‚îÄ original_language: enum (ko, zh)
‚îú‚îÄ‚îÄ translated_message: text
‚îú‚îÄ‚îÄ translated_language: enum (ko, zh)
‚îú‚îÄ‚îÄ message_type: enum (text, file, image, video)
‚îú‚îÄ‚îÄ file_url: string
‚îú‚îÄ‚îÄ file_name: string
‚îú‚îÄ‚îÄ file_size: bigint
‚îú‚îÄ‚îÄ created_at: timestamp
‚îî‚îÄ‚îÄ is_deleted: boolean

chat_participants
‚îú‚îÄ‚îÄ id: uuid
‚îú‚îÄ‚îÄ reservation_number: string (FK ‚Üí inspection_applications.reservation_number)
‚îú‚îÄ‚îÄ user_id: uuid (FK ‚Üí users.id)
‚îú‚îÄ‚îÄ role: string
‚îú‚îÄ‚îÄ is_online: boolean
‚îú‚îÄ‚îÄ last_seen: timestamp
‚îú‚îÄ‚îÄ joined_at: timestamp
‚îî‚îÄ‚îÄ left_at: timestamp

-- File Management
uploaded_files
‚îú‚îÄ‚îÄ id: uuid
‚îú‚îÄ‚îÄ reservation_number: string (FK ‚Üí inspection_applications.reservation_number)
‚îú‚îÄ‚îÄ uploaded_by: uuid (FK ‚Üí users.id)
‚îú‚îÄ‚îÄ original_filename: string
‚îú‚îÄ‚îÄ file_path: string
‚îú‚îÄ‚îÄ file_size: bigint
‚îú‚îÄ‚îÄ file_type: string
‚îú‚îÄ‚îÄ mime_type: string
‚îú‚îÄ‚îÄ upload_purpose: enum (application, chat, report)
‚îú‚îÄ‚îÄ created_at: timestamp
‚îî‚îÄ‚îÄ is_deleted: boolean

-- Reports
inspection_reports
‚îú‚îÄ‚îÄ id: uuid
‚îú‚îÄ‚îÄ reservation_number: string (FK ‚Üí inspection_applications.reservation_number)
‚îú‚îÄ‚îÄ original_filename: string
‚îú‚îÄ‚îÄ file_path: string
‚îú‚îÄ‚îÄ report_type: string
‚îú‚îÄ‚îÄ status: enum (uploaded, processing, completed)
‚îú‚îÄ‚îÄ uploaded_by: uuid (FK ‚Üí users.id)
‚îú‚îÄ‚îÄ uploaded_at: timestamp
‚îú‚îÄ‚îÄ report_url: string
‚îú‚îÄ‚îÄ translated_content: jsonb
‚îî‚îÄ‚îÄ approved_by: uuid (FK ‚Üí users.id)

-- CRM
crm_companies
‚îú‚îÄ‚îÄ id: uuid
‚îú‚îÄ‚îÄ company_name: string
‚îú‚îÄ‚îÄ company_name_cleaned: string
‚îú‚îÄ‚îÄ official_website: string
‚îú‚îÄ‚îÄ phone_number: string
‚îú‚îÄ‚îÄ fax_number: string
‚îú‚îÄ‚îÄ email: string
‚îú‚îÄ‚îÄ address: text
‚îú‚îÄ‚îÄ estimated_revenue: decimal
‚îú‚îÄ‚îÄ assigned_sales_person: uuid (FK ‚Üí users.id)
‚îú‚îÄ‚îÄ last_contact_date: date
‚îú‚îÄ‚îÄ next_follow_up_date: date
‚îú‚îÄ‚îÄ created_at: timestamp
‚îî‚îÄ‚îÄ updated_at: timestamp

-- Logs
activity_logs
‚îú‚îÄ‚îÄ id: uuid
‚îú‚îÄ‚îÄ user_id: uuid (FK ‚Üí users.id)
‚îú‚îÄ‚îÄ action: string
‚îú‚îÄ‚îÄ entity_type: string
‚îú‚îÄ‚îÄ entity_id: uuid
‚îú‚îÄ‚îÄ metadata: jsonb
‚îú‚îÄ‚îÄ ip_address: inet
‚îî‚îÄ‚îÄ created_at: timestamp

change_logs
‚îú‚îÄ‚îÄ id: uuid
‚îú‚îÄ‚îÄ reservation_number: string (FK ‚Üí inspection_applications.reservation_number)
‚îú‚îÄ‚îÄ changed_by: uuid (FK ‚Üí users.id)
‚îú‚îÄ‚îÄ field_name: string
‚îú‚îÄ‚îÄ old_value: text
‚îú‚îÄ‚îÄ new_value: text
‚îú‚îÄ‚îÄ change_reason: text
‚îî‚îÄ‚îÄ created_at: timestamp
```

### RLS (Row Level Security) Policies

```sql
-- Examples of key RLS policies
-- Customers can only see their own data
CREATE POLICY "customers_own_data" ON inspection_applications
FOR SELECT USING (auth.uid() = user_id);

-- Chinese staff can see assigned inspections
CREATE POLICY "chinese_staff_assigned" ON inspection_applications
FOR SELECT USING (
  auth.uid() = assigned_chinese_staff 
  OR EXISTS (
    SELECT 1 FROM user_profiles 
    WHERE user_id = auth.uid() 
    AND role = 'chinese_staff'
  )
);

-- Korean team can see everything
CREATE POLICY "korean_team_all_access" ON inspection_applications
FOR ALL USING (
  EXISTS (
    SELECT 1 FROM user_profiles 
    WHERE user_id = auth.uid() 
    AND role IN ('korean_team', 'admin')
  )
);
```

## API Endpoints

### Authentication Endpoints
```typescript
// Auth routes
POST   /api/auth/register          // User registration
POST   /api/auth/login            // User login
POST   /api/auth/logout           // User logout
POST   /api/auth/refresh          // Refresh token
GET    /api/auth/profile          // Get user profile
PUT    /api/auth/profile          // Update user profile
POST   /api/auth/guest-url        // Generate guest URL for factory/inspector
```

### Application Management
```typescript
// Application routes
POST   /api/applications                      // Create new application
GET    /api/applications                      // List applications (filtered by role)
GET    /api/applications/:reservationNumber   // Get application details
PUT    /api/applications/:reservationNumber   // Update application
DELETE /api/applications/:reservationNumber   // Cancel application

// Application actions
POST   /api/applications/:reservationNumber/quote      // Send quote
POST   /api/applications/:reservationNumber/payment    // Confirm payment
POST   /api/applications/:reservationNumber/schedule   // Update schedule
POST   /api/applications/:reservationNumber/assign     // Assign staff
```

### Chat System
```typescript
// Chat routes
GET    /api/chat/:reservationNumber/messages     // Get chat messages
POST   /api/chat/:reservationNumber/messages     // Send message
PUT    /api/chat/:reservationNumber/messages/:id // Update message
DELETE /api/chat/:reservationNumber/messages/:id // Delete message

// Chat real-time
GET    /api/chat/:reservationNumber/participants // Get participants
POST   /api/chat/:reservationNumber/typing       // Send typing indicator
POST   /api/chat/:reservationNumber/read         // Mark messages as read
```

### File Management
```typescript
// File routes
POST   /api/files/upload              // Upload file
GET    /api/files/:fileId            // Download file
DELETE /api/files/:fileId            // Delete file
POST   /api/files/compress           // Compress image/video
```

### Report Management
```typescript
// Report routes
POST   /api/reports/:reservationNumber/upload     // Upload report
GET    /api/reports/:reservationNumber            // Get reports
POST   /api/reports/:reservationNumber/translate  // Translate report
POST   /api/reports/:reservationNumber/approve    // Approve report
```

### Translation Service
```typescript
// Translation routes
POST   /api/translate                 // Translate text
POST   /api/translate/batch          // Batch translate
GET    /api/translate/usage          // Get usage statistics
```

### Admin Routes
```typescript
// Admin routes (korean_team only)
GET    /api/admin/stats              // Dashboard statistics
GET    /api/admin/users              // List all users
PUT    /api/admin/users/:id/approve  // Approve user
PUT    /api/admin/users/:id/reject   // Reject user
GET    /api/admin/logs               // System logs
PUT    /api/admin/settings           // Update system settings
```

## Chat System Implementation Details

### Architecture Overview
The chat system is built on Supabase Realtime with GPT-4 translation layer.

### Implementation Steps

1. **Set up Supabase Realtime channels**
```typescript
// Subscribe to chat messages
const channel = supabase.channel(`chat:${reservationNumber}`)
  .on('postgres_changes', {
    event: 'INSERT',
    schema: 'public',
    table: 'chat_messages',
    filter: `reservation_number=eq.${reservationNumber}`
  }, handleNewMessage)
  .subscribe()
```

2. **Message Flow with Translation**
```typescript
// Send message flow
async function sendMessage(message: string) {
  // 1. Detect language
  const language = detectLanguage(message)
  
  // 2. Translate if needed
  const translated = await translateMessage(message, language)
  
  // 3. Insert to database
  const { data, error } = await supabase
    .from('chat_messages')
    .insert({
      original_message: message,
      original_language: language,
      translated_message: translated.text,
      translated_language: translated.targetLang,
      // ... other fields
    })
}
```

3. **Role-based Message Display**
```typescript
// Display logic
function displayMessage(message: ChatMessage, userRole: string) {
  switch(userRole) {
    case 'customer':
      // Korean customers see Korean only
      return message.original_language === 'ko' 
        ? message.original_message 
        : message.translated_message
        
    case 'chinese_staff':
    case 'factory':
    case 'inspector':
      // Chinese users see Chinese only
      return message.original_language === 'zh' 
        ? message.original_message 
        : message.translated_message
        
    case 'korean_team':
    case 'admin':
      // Korean team sees both
      return {
        original: message.original_message,
        translated: message.translated_message
      }
  }
}
```

### Recommended Chat UI Libraries
- **Option 1**: Custom implementation with Supabase Realtime
- **Option 2**: [react-chat-elements](https://github.com/detaysoft/react-chat-elements)
- **Option 3**: [stream-chat-react](https://github.com/GetStream/stream-chat-react)
- **Option 4**: Modify [Supabase Chat Example](https://github.com/supabase/supabase/tree/master/examples/realtime/nextjs-realtime-chat)

## Deployment Strategy

### Development Workflow
1. **Local Development**: Use Supabase local development
2. **Staging**: Deploy to Vercel preview branches
3. **Production**: Deploy to main Vercel deployment

### Environment Management
```bash
# Local development
.env.local

# Staging
.env.staging

# Production
.env.production
```

## üîí Security & Backup Policy

### Data Backup Strategy
**‚ö†Ô∏è CRITICAL SECURITY NOTICE**:
- **NEVER** store production data in GitHub (Actions, Artifacts, or repositories)
- **NEVER** create scripts that export customer data to external services
- **ALWAYS** use Supabase's built-in backup features for production data

#### Approved Backup Methods:
1. **Production Database**: 
   - Use Supabase Dashboard ‚Üí Settings ‚Üí Database ‚Üí Backups
   - Enable Point-in-time Recovery (PITR)
   - Automatic daily backups (30-day retention)
   
2. **Development Database**:
   - Local backups only with test data
   - Use `pg_dump` for local development snapshots
   
3. **Compliance**:
   - All backups must comply with Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏Î≤ï (PIPA)
   - Customer data must remain within Supabase's secure infrastructure
   - No customer data in version control or CI/CD pipelines

### CI/CD Pipeline (GitHub Actions)
```yaml
name: Deploy
on:
  push:
    branches: [main, staging]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm install
      - run: npm test
      - run: npm run build
      - uses: vercel/action@v3
```

### Monitoring and Logging
- **Error Tracking**: Sentry integration
- **Analytics**: Google Analytics / Vercel Analytics
- **Logs**: Supabase logs + custom logging to activity_logs table
- **Performance**: Vercel Speed Insights

## Common Development Tasks (with MCP Tools & Documentation)

### üîç **Í∞úÎ∞ú ÏãúÏûë Ï†Ñ Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏**
```bash
# 1. MCP ÎèÑÍµ¨Î°ú ÌòÑÏû¨ ÏÉÅÌÉú ÌååÏïÖ
‚ñ° desktop MCP: ÌòÑÏû¨ Íµ¨ÌòÑ ÏÉÅÌÉú ÌôïÏù∏
‚ñ° supabase MCP: DB Ïä§ÌÇ§Îßà ÌòÑÌô© ÌôïÏù∏
‚ñ° seq MCP: ÏûëÏóÖ Í≥ÑÌöç ÏàòÎ¶Ω

# 2. Î¨∏ÏÑú ÌôïÏù∏ (ÌïÑÏàò)
‚ñ° 07_REQUIREMENTS.md: ÏöîÍµ¨ÏÇ¨Ìï≠ ÌôïÏù∏
‚ñ° Ìï¥Îãπ ÏÑ§Í≥Ñ Î¨∏ÏÑú: ÏïÑÌÇ§ÌÖçÏ≤ò Ïù¥Ìï¥
‚ñ° 14_CODE_STANDARDS.md: ÏΩîÎî© Í∑úÎ≤î ÌôïÏù∏
‚ñ° 15_ACCEPTANCE_CRITERIA.md: ÏôÑÎ£å Í∏∞Ï§Ä ÌôïÏù∏
```

### Adding a New Page
```bash
# Step 1: Î¨∏ÏÑú ÌôïÏù∏ (desktop MCP ÏÇ¨Ïö©)
mcp__desktop-commander read_file {
  path: "project-docs/09_FRONTEND_DESIGN.md"
}

# Step 2: Í∏∞Ï°¥ Íµ¨ÌòÑ Î∂ÑÏÑù (desktop MCP ÏÇ¨Ïö©)
mcp__desktop-commander search_code {
  path: "nextjs/src/app",
  pattern: "similar-page-pattern"
}

# Step 3: Íµ¨ÌòÑ (Ï∞∏Ï°∞ Î¨∏ÏÑú)
- 09_FRONTEND_DESIGN.md ‚Üí ÌéòÏù¥ÏßÄ Íµ¨Ï°∞
- SERVICE_FIELDS_DEFINITION.md ‚Üí ÌïÑÎìú Ï†ïÏùò
- 14_CODE_STANDARDS.md ‚Üí ÏΩîÎî© Í∑úÎ≤î

# Step 4: Î≥ÄÍ≤ΩÏÇ¨Ìï≠ Í∏∞Î°ù
- 19_CHANGELOG.md ÏóÖÎç∞Ïù¥Ìä∏
```

### Implementing Real-time Features
```bash
# Ï∞∏Ï°∞ Î¨∏ÏÑú: 11_DATABASE_DESIGN.md (Realtime ÏÑπÏÖò)
# MCP ÌôúÏö©: supabase MCPÎ°ú realtime Ï±ÑÎÑê ÌôïÏù∏

# Step 1: DB Ïä§ÌÇ§Îßà ÌôïÏù∏
mcp__supabase list_tables {
  schemas: ["public"]
}

# Step 2: Realtime Íµ¨ÌòÑ (08_TECH_ARCHITECTURE.md Ï∞∏Ï°∞)
1. Supabase Realtime subscriptions
2. Handle connection state properly
3. Implement optimistic updates for better UX
4. Always consider translation needs
```

### Working with Translations
```bash
# Ï∞∏Ï°∞ Î¨∏ÏÑú: 07_REQUIREMENTS.md (Î≤àÏó≠ ÏöîÍµ¨ÏÇ¨Ìï≠)
# MCP ÌôúÏö©: c7 MCPÎ°ú OpenAI ÎùºÏù¥Î∏åÎü¨Î¶¨ Î¨∏ÏÑú ÌôïÏù∏

mcp__context7-mcp get-library-docs {
  context7CompatibleLibraryID: "/openai/openai-node",
  topic: "chat completions"
}
```

### Adding New Database Tables
```bash
# Ï∞∏Ï°∞ Î¨∏ÏÑú: 11_DATABASE_DESIGN.md, SERVICE_FIELDS_DEFINITION.md

# Step 1: Ïä§ÌÇ§Îßà ÏÑ§Í≥Ñ Í≤ÄÌÜ† (seq MCP ÏÇ¨Ïö©)
mcp__mcp-sequentialthinking-tools sequentialthinking_tools {
  available_mcp_tools: ["mcp__supabase"],
  thought: "ÏÉà ÌÖåÏù¥Î∏î ÏÑ§Í≥Ñ Í≤ÄÌÜ†"
}

# Step 2: ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò ÏÉùÏÑ± (supabase MCP ÏÇ¨Ïö©)
mcp__supabase apply_migration {
  name: "add_new_table",
  query: "CREATE TABLE ..."
}

# Step 3: RLS Ï†ïÏ±Ö Ï†ÅÏö© (11_DATABASE_DESIGN.md ÏÑπÏÖò 5.5 Ï∞∏Ï°∞)
# Step 4: TypeScript ÌÉÄÏûÖ ÏÉùÏÑ±
npx supabase gen types typescript --linked > nextjs/src/lib/types/database.ts

# Step 5: Î¨∏ÏÑú ÏóÖÎç∞Ïù¥Ìä∏
- 11_DATABASE_DESIGN.mdÏóê ÏÉà ÌÖåÏù¥Î∏î Ï∂îÍ∞Ä
- 19_CHANGELOG.mdÏóê Î≥ÄÍ≤ΩÏÇ¨Ìï≠ Í∏∞Î°ù
```

### Working with Global State
```typescript
// Ï∞∏Ï°∞ Î¨∏ÏÑú: 08_TECH_ARCHITECTURE.md (ÏÉÅÌÉú Í¥ÄÎ¶¨ ÏÑπÏÖò)
// In components
import { useUser } from '@/lib/context/GlobalContext'
const { user, userProfile, loading } = useUser()

// In providers
import { GlobalProvider } from '@/lib/context/GlobalContext'
// Wrap your app with <GlobalProvider>
```

### Testing Strategy
```bash
# Ï∞∏Ï°∞ Î¨∏ÏÑú: 13_TEST_PLAN.md

# MCP ÌôúÏö© ÏòàÏãú
# 1. ÌÖåÏä§Ìä∏ ÏãúÎÇòÎ¶¨Ïò§ Í≥ÑÌöç (seq MCP)
mcp__mcp-sequentialthinking-tools sequentialthinking_tools {
  available_mcp_tools: ["mcp__desktop-commander"],
  thought: "ÌÖåÏä§Ìä∏ ÏãúÎÇòÎ¶¨Ïò§ ÏàòÎ¶Ω"
}

# 2. ÌÖåÏä§Ìä∏ Ïã§Ìñâ (desktop MCP)
mcp__desktop-commander start_process {
  command: "cd nextjs && npm test",
  timeout_ms: 60000
}

# ÌÖåÏä§Ìä∏ Ï¢ÖÎ•ò (13_TEST_PLAN.md Ï∞∏Ï°∞)
1. **Unit Tests**: Jest + React Testing Library
2. **Integration Tests**: Playwright  
3. **Database Tests**: pgTAP (supabase MCP ÏÇ¨Ïö©)
4. **API Tests**: Supertest
```

## Development Best Practices

### Code Organization (14_CODE_STANDARDS.md Ï§ÄÏàò)
- Use barrel exports for cleaner imports
- Separate business logic from UI components  
- Create custom hooks for repeated logic
- Use TypeScript strict mode
- Follow file naming conventions from 14_CODE_STANDARDS.md

### Performance Optimization (11_DATABASE_DESIGN.md ÏÑπÏÖò 5.5 Ï∞∏Ï°∞)
- Implement lazy loading for routes
- Use React.memo for expensive components
- Optimize images with next/image
- Implement virtual scrolling for long lists
- Apply RLS optimization patterns (`SELECT auth.uid()` wrapping)
- Use database indexes strategically

### Security Checklist (14_CODE_STANDARDS.md ÏÑπÏÖò 9 ÌïÑÎèÖ)
- [ ] Input validation with Zod schemas
- [ ] XSS prevention (sanitize user input)
- [ ] CSRF protection implementation
- [ ] Rate limiting on APIs (12_API_DOCUMENTATION.md Ï∞∏Ï°∞)
- [ ] Secure file upload validation (magic number verification)
- [ ] SQL injection prevention (use parameterized queries)
- [ ] Proper error handling (don't expose sensitive info)
- [ ] Security headers configuration (16_DEPLOYMENT.md Ï∞∏Ï°∞)

## üìä ÌîÑÎ°úÏ†ùÌä∏ ÏßÑÌñâ Ï∂îÏ†Å

### üìö **ÌîÑÎ°úÏ†ùÌä∏ Î¨∏ÏÑú ÌòÑÌô©**
- **Ï¥ù Î¨∏ÏÑú**: 20Í∞ú (100% ÏôÑÎ£å) üéâ
- **Î¨∏ÏÑú ÏúÑÏπò**: `/project-docs/` Ìè¥Îçî
- **Î≥ÄÍ≤Ω Ï∂îÏ†Å**: `19_CHANGELOG.md`ÏóêÏÑú Í¥ÄÎ¶¨

### üìù **Î¨∏ÏÑú ÏóÖÎç∞Ïù¥Ìä∏ Í∑úÏπô**
```bash
# ÏΩîÎìú Î≥ÄÍ≤Ω Ïãú Î¨∏ÏÑú ÏóÖÎç∞Ïù¥Ìä∏ ÌîÑÎ°úÏÑ∏Ïä§
1. Í∏∞Îä• Íµ¨ÌòÑ/ÏàòÏ†ï ÏôÑÎ£å
   ‚Üì
2. Í¥ÄÎ†® ÏÑ§Í≥Ñ Î¨∏ÏÑú ÏóÖÎç∞Ïù¥Ìä∏ (ÌïÑÏöîÏãú)
   - 11_DATABASE_DESIGN.md (DB Î≥ÄÍ≤Ω)
   - 12_API_DOCUMENTATION.md (API Î≥ÄÍ≤Ω)
   - SERVICE_FIELDS_DEFINITION.md (ÌïÑÎìú Î≥ÄÍ≤Ω)
   ‚Üì
3. 19_CHANGELOG.mdÏóê Î≥ÄÍ≤ΩÏÇ¨Ìï≠ Í∏∞Î°ù
   ‚Üì
4. Git commit with reference to docs
   Ïòà: "feat: add payment API (ref: 12_API_DOCUMENTATION.md)"
```

### üóìÔ∏è **ÏµúÍ∑º ÏôÑÎ£å ÏûëÏóÖ (2025-01-27)**

#### ‚úÖ **ÌîÑÎ°úÏ†ùÌä∏ Î¨∏ÏÑúÌôî 100% ÏôÑÎ£å**
- 20Í∞ú ÌëúÏ§Ä Î¨∏ÏÑú ÏûëÏÑ± ÏôÑÎ£å
- ÏÑ±Îä• ÏµúÏ†ÅÌôî Í∞ÄÏù¥Îìú Ï∂îÍ∞Ä (RLS 40% Í∞úÏÑ†)
- Rate Limiting Íµ¨ÌòÑ Í∞ÄÏù¥Îìú Ï∂îÍ∞Ä
- Î≥¥Ïïà Î™®Î≤î ÏÇ¨Î°Ä Î¨∏ÏÑúÌôî
- ÌîÑÎ°úÎçïÏÖò Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ ÏôÑÏÑ±

#### ‚úÖ **ÏÑúÎπÑÏä§ ÌÉÄÏûÖ ÌôïÏû• (2025-01-25)**
- **Í∏∞Ï°¥**: 3Í∞ú Í≤ÄÌíà ÏÑúÎπÑÏä§Îßå ÏßÄÏõê
- **Í∞úÏÑ†**: 7Í∞ú ÏÑúÎπÑÏä§Î°ú ÌôïÏû• (Í≤ÄÌíà 3Í∞ú + ÏàòÏûÖÎåÄÌñâ 4Í∞ú)
- **Ï∞∏Ï°∞**: SERVICE_FIELDS_DEFINITION.md (691Ï§Ñ ÏÉÅÏÑ∏ Î™ÖÏÑ∏)

### üìã **Îã§Ïùå Ïö∞ÏÑ†ÏàúÏúÑ** (04_PROJECT_SCHEDULE.md Ï∞∏Ï°∞)
1. **Sprint 1**: Core Í∏∞Îä• Íµ¨ÌòÑ (2025-02-03 ~ 02-16)
   - Ïù∏Ï¶ù ÏãúÏä§ÌÖú (07_REQUIREMENTS.md FR-001~004)
   - Ïã†Ï≤≠ÏÑú ÏûëÏÑ± (09_FRONTEND_DESIGN.md ÏÑπÏÖò 3.2)
   
2. **Sprint 2**: Ï±ÑÌåÖ ÏãúÏä§ÌÖú (2025-02-17 ~ 03-02)
   - Ïã§ÏãúÍ∞Ñ Ï±ÑÌåÖ (11_DATABASE_DESIGN.md chat_messages)
   - GPT-4 Î≤àÏó≠ (08_TECH_ARCHITECTURE.md ÏÑπÏÖò 3.5)

3. **Sprint 3**: CRM & Î¶¨Ìè¨Ìä∏ (2025-03-03 ~ 03-16)
   - CRM ÏãúÏä§ÌÖú (11_DATABASE_DESIGN.md crm_companies)
   - Î¶¨Ìè¨Ìä∏ ÏÉùÏÑ± (10_BACKEND_DESIGN.md ÏÑπÏÖò 4.4)

### üöÄ **MCP ÎèÑÍµ¨ ÌôúÏö© ÌÜµÍ≥Ñ**
```bash
# Í∂åÏû• MCP ÏÇ¨Ïö© Ìå®ÌÑ¥
- desktop MCP: ÌååÏùº ÏûëÏóÖÏùò 70% Ïù¥ÏÉÅ ÌôúÏö©
- supabase MCP: Î™®Îì† DB ÏûëÏóÖÏóê ÌïÑÏàò ÏÇ¨Ïö©
- seq MCP: Î≥µÏû°Ìïú Í∏∞Îä• Íµ¨ÌòÑ Ïãú Í≥ÑÌöç ÏàòÎ¶Ω
- c7 MCP: Ïô∏Î∂Ä ÎùºÏù¥Î∏åÎü¨Î¶¨ Î¨∏ÏÑú Ï∞∏Ï°∞
```

## üìë **ÌîÑÎ°úÏ†ùÌä∏ Î¨∏ÏÑú Îπ†Î•∏ Ï∞∏Ï°∞**

### ÏûêÏ£º Ï∞∏Ï°∞ÌïòÎäî Î¨∏ÏÑú TOP 10
1. **07_REQUIREMENTS.md** - Í∏∞Îä• ÏöîÍµ¨ÏÇ¨Ìï≠ ÌôïÏù∏
2. **09_FRONTEND_DESIGN.md** - UI/UX ÏÑ§Í≥Ñ (82Í∞ú ÌéòÏù¥ÏßÄ)
3. **11_DATABASE_DESIGN.md** - DB Ïä§ÌÇ§Îßà & RLS Ï†ïÏ±Ö
4. **12_API_DOCUMENTATION.md** - API ÏóîÎìúÌè¨Ïù∏Ìä∏ Î™ÖÏÑ∏
5. **14_CODE_STANDARDS.md** - ÏΩîÎî© Í∑úÎ≤î & Î≥¥Ïïà Í∞ÄÏù¥Îìú
6. **SERVICE_FIELDS_DEFINITION.md** - 7Í∞ú ÏÑúÎπÑÏä§ ÌïÑÎìú Ï†ïÏùò
7. **13_TEST_PLAN.md** - ÌÖåÏä§Ìä∏ Ï†ÑÎûµ & Î∞©Î≤ïÎ°†
8. **16_DEPLOYMENT.md** - Î∞∞Ìè¨ Ï†àÏ∞® & Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏
9. **15_ACCEPTANCE_CRITERIA.md** - Í∏∞Îä•Î≥Ñ ÏôÑÎ£å Í∏∞Ï§Ä
10. **19_CHANGELOG.md** - Î≥ÄÍ≤Ω Ïù¥Î†• Ï∂îÏ†Å

### Î¨∏ÏÑúÎ≥Ñ ÌïµÏã¨ ÎÇ¥Ïö©
```bash
# ÎπÑÏ¶àÎãàÏä§ Ïù¥Ìï¥
01_PROJECT_CHARTER.md     ‚Üí ÌîÑÎ°úÏ†ùÌä∏ Î≤îÏúÑÏôÄ Î™©Ìëú
02_BUSINESS_CASE.md       ‚Üí ROI 470%, Ïó∞ 5.4Ïñµ ÏàòÏùµ Ï¶ùÎåÄ

# Í∏∞Ïà† Íµ¨ÌòÑ
08_TECH_ARCHITECTURE.md   ‚Üí Next.js 15 + Supabase Ïä§ÌÉù
10_BACKEND_DESIGN.md      ‚Üí API Routes & Edge Functions
11_DATABASE_DESIGN.md     ‚Üí RLS ÏµúÏ†ÅÌôî (40% ÏÑ±Îä• Í∞úÏÑ†)

# ÌíàÏßà Î≥¥Ï¶ù
13_TEST_PLAN.md          ‚Üí Jest, Playwright, pgTAP
14_CODE_STANDARDS.md     ‚Üí TypeScript, React Î≤†Ïä§Ìä∏ ÌîÑÎûôÌã∞Ïä§

# Ïö¥ÏòÅ Ï§ÄÎπÑ
16_DEPLOYMENT.md         ‚Üí Vercel + Supabase Î∞∞Ìè¨
17_OPERATIONS_MANUAL.md  ‚Üí Î™®ÎãàÌÑ∞ÎßÅ & Ïö¥ÏòÅ Í∞ÄÏù¥Îìú
```

### üéØ **Í∞úÎ∞ú Ï≤†Ìïô**
> "Î¨∏ÏÑú Í∏∞Î∞ò Í∞úÎ∞ú - Î™®Îì† ÏΩîÎìúÎäî Î¨∏ÏÑúÏóê Í∑ºÍ±∞ÌïòÍ≥†, Î™®Îì† Î≥ÄÍ≤ΩÏùÄ Î¨∏ÏÑúÏóê Î∞òÏòÅÎêúÎã§"

---
*Last Updated: 2025-01-27*
*Total Project Documents: 20/20 (100% Complete)*